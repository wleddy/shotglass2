{% include 'map_headers.html' %}

{% if marker_data['markers'] %}
    <script type="text/javascript">
        // Initialize the map
        var map = new Map('{{ site_config.MAPBOX_PROJECT_ID }}', '{{ site_config.MAPBOX_ACCESS_TOKEN }}',"{{ target_id }}");
        // Add markers
    	map.addMarkersFromJSON('{{marker_data|tojson|safe}}','{{ url_for("map.map_error") }}');
    </script>
{% else %}
{# A simple map#}
    <script>
      var map = L.map('map').setView([40.91, -96.63], 4);

      L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={{ site_config.MAPBOX_ACCESS_TOKEN }}', {
          attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
          '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
          id: '{{ site_config.MAPBOX_PROJECT_ID }}',
          accessToken: '{{ site_config.MAPBOX_ACCESS_TOKEN }}'
      }).addTo(map);
    </script>
{% endif %}
